## TDDFT Absorption Spectrum from Real-Time Dipole

This script processes dipole moment data from real-time TDDFT simulations (e.g., from **SIESTA 5**) to generate an absorption spectrum using a **Voigt broadening** scheme (Gaussian × Lorentzian).

### Input Format

- **`siesta.TDDIPOL`**: Input file containing dipole moments.
- The columns are:
  1. Time (in **fs**)
  2. Dipole-X
  3. Dipole-Y
  4. Dipole-Z

In this example, the external delta kick electric field is applied along the **z-direction**.

---

### Suggestions

1. **Run a ~20 fs RT-TDDFT simulation**  
   - `10 fs` is too short — spectral resolution is poor.  
   - `30–40 fs` may result in worse spectra due to numerical noise or edge artifacts.

2. **Adjust key parameters in the script**:
   ```python
   eta = 0.2         # Lorentzian broadening (in eV), typical range: 0.05–0.3 eV
   sigma = T / 15    # Gaussian window width (in fs), typical range: T/5 – T/10

T is the total propagation time in fs.

These parameters jointly determine spectral resolution and smoothness.

3. File source

siesta.TDDIPOL is generated by SIESTA 5 in a real-time TDDFT calculation.

4. Language note

If you see Chinese characters in comments or labels, you can easily translate them with Google Translate. (But the code itself is fully functional without modification.)

5. Explore & have fun!
Try different values of eta and sigma, experiment with different kick directions, and analyze how your spectrum evolves.

<img width="1920" height="1440" alt="spectrum" src="https://github.com/user-attachments/assets/fab30644-3bc1-49dc-808a-5b9a0f794313" />

